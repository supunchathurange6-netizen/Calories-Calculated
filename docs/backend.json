{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user's profile, including personal information and activity level.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile, same as Firebase Auth UID."
        },
        "name": {
          "type": "string",
          "description": "User's name."
        },
        "age": {
          "type": "number",
          "description": "User's age in years."
        },
        "gender": {
          "type": "string",
          "enum": ["male", "female"],
          "description": "User's gender."
        },
        "height": {
          "type": "number",
          "description": "User's height in centimeters."
        },
        "weight": {
          "type": "number",
          "description": "User's weight in kilograms."
        },
        "activityLevel": {
          "type": "string",
          "enum": ["low", "medium", "high"],
          "description": "User's activity level."
        },
        "goal": {
          "type": "string",
          "enum": ["lose", "maintain", "gain"],
          "description": "User's weight management goal."
        }
      },
      "required": [
        "id",
        "name",
        "age",
        "gender",
        "height",
        "weight",
        "activityLevel",
        "goal"
      ]
    },
    "Food": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Food",
      "type": "object",
      "description": "Represents a food item with its nutritional information.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the food item."
        },
        "name": {
          "type": "string",
          "description": "Name of the food item."
        },
        "calories": {
          "type": "number",
          "description": "Calories per serving."
        },
        "protein": {
          "type": "number",
          "description": "Protein (g) per serving."
        },
        "carbs": {
          "type": "number",
          "description": "Carbohydrates (g) per serving."
        },
        "fat": {
          "type": "number",
          "description": "Fat (g) per serving."
        },
        "isCustom": {
          "type": "boolean",
          "description": "True if the food item was created by a user."
        }
      },
      "required": ["id", "name", "calories", "protein", "carbs", "fat"]
    },
    "LoggedFood": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "LoggedFood",
      "type": "object",
      "description": "Represents a user's food intake entry for a specific meal, extending a base Food item.",
      "allOf": [
        { "$ref": "#/entities/Food" }
      ],
      "properties": {
        "userProfileId": {
          "type": "string",
          "description": "The UID of the user who logged the food."
        },
        "mealType": {
          "type": "string",
          "enum": ["breakfast", "lunch", "dinner", "snacks"],
          "description": "The type of meal."
        },
        "servings": {
          "type": "number",
          "description": "Number of servings consumed."
        },
        "timestamp": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp of when the food was logged."
        }
      },
      "required": ["userProfileId", "mealType", "servings", "timestamp"]
    },
    "WeightEntry": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WeightEntry",
      "type": "object",
      "description": "Represents a user's weight entry on a specific date.",
      "properties": {
        "date": {
          "type": "string",
          "format": "date",
          "description": "The date of the weight entry (YYYY-MM-DD)."
        },
        "weight": {
          "type": "number",
          "description": "The user's weight in kilograms."
        }
      },
      "required": ["date", "weight"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": { "$ref": "#/entities/UserProfile" },
          "description": "Stores user profile information. The document ID is the Firebase Auth UID."
        }
      },
      {
        "path": "/users/{userId}/foodEntries/{foodEntryId}",
        "definition": {
          "entityName": "LoggedFood",
          "schema": { "$ref": "#/entities/LoggedFood" },
          "description": "Stores food log entries for a user."
        }
      },
      {
        "path": "/users/{userId}/customFoods/{customFoodId}",
        "definition": {
          "entityName": "Food",
          "schema": { "$ref": "#/entities/Food" },
          "description": "Stores custom food items created by a user."
        }
      },
      {
        "path": "/users/{userId}/weightHistory/{weightEntryId}",
        "definition": {
          "entityName": "WeightEntry",
          "schema": { "$ref": "#/entities/WeightEntry" },
          "description": "Stores the weight history for a user. The document ID is the date (YYYY-MM-DD)."
        }
      }
    ],
    "reasoning": "The Firestore structure is designed for a user-centric data model. All user-specific data, including food entries, custom foods, and weight history, is stored in subcollections under that user's document in the top-level 'users' collection. This simplifies security rules by allowing path-based access control, ensuring users can only access their own data. It improves query performance by scoping queries to a single user's data tree. This model follows Firestore's best practices for scalability and security."
  }
}
